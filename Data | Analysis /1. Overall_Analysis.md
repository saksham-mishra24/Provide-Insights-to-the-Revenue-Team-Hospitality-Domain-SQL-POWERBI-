1st Metric 
## REVENUE
## 1.1  Revenue :

```` sql
SELECT
  CONCAT(ROUND(SUM(revenue_realized) / 1000000 , 0), ' M') AS Revenue
FROM bookings_Table;
````
#### Answer:

```
Revenue 
 1709 M
```

## 1.2 BY MONTH :
```sql
SELECT B.Month_year,
CONCAT(ROUND(SUM(A.revenue_generated) / 1000000 , 0), ' M') AS Realised_generated,
CONCAT(ROUND(SUM(A.revenue_realized) / 1000000 , 0), ' M') AS Realised_revenue
FROM bookings_Table A
JOIN Date_Table B
ON A.check_in_date = B.Date
GROUP BY B.Month_year
ORDER BY SUM(a.revenue_generated) desc, SUM(A.revenue_realized) DESC  
```
#### Answer:
Month_year	Realised_generated	Realised_revenue
May 2022	684 M	582 M
Jul 2022	672 M	573 M
Jun 2022	652 M	554 M

## 1.3 BY CITY :
```sql

SELECT h.city,
       CONCAT(ROUND(SUM(b.revenue_generated) / 1000000 , 0), ' M') AS Realised_generated,
       CONCAT(ROUND(SUM(b.revenue_realized) / 1000000, 0), ' M') AS Realized_revenue
FROM bookings_Table b
JOIN hotels h ON b.property_id = h.property_id
GROUP BY h.city
ORDER BY SUM(a.revenue_generated) desc, SUM(A.revenue_realized) DESC 

```

city	Realised_generated	Realized_revenue
Mumbai	785 M	669 M
Bangalore	495 M	420 M
Hyderabad	381 M	325 M
Delhi	346 M	295 M


## 1.4 BY Day_type :
```sql

SELECT 
      b.Day_type,
	   CONCAT(ROUND(SUM(a.revenue_generated) / 1000000 , 0), ' M') AS Realised_generated,
       CONCAT(ROUND(SUM(A.revenue_realized) / 1000000 , 0), ' M') AS Realised_revenue
FROM bookings_Table A
JOIN Date_Table B ON A.check_in_date = B.Date
GROUP BY  b.Day_type
ORDER BY  SUM(a.revenue_generated) desc, SUM(A.revenue_realized) DESC 
```

Day_type	Realised_generated	Realised_revenue
Weekday	1259 M	1070 M
Weekend	748 M	639 M

## 1.5 BY ROOM_CLASS :

```SQL
SELECT r.room_class,
        CONCAT(ROUND(SUM(b.revenue_generated) / 1000000 , 0), ' M') AS Realised_generated,
       CONCAT(ROUND(SUM(b.revenue_realized) / 1000000, 0), ' M') AS Realized_revenue
FROM bookings_Table b
JOIN rooms r ON b.room_category = r.room_id
GROUP BY r.room_class
ORDER BY  SUM(b.revenue_generated) desc, SUM(b.revenue_realized) DESC 

```

room_class	Realised_generated	Realized_revenue
Elite	659 M	560 M
Premium	544 M	462 M
Presidential	441 M	377 M
Standard	364 M	310 M

## 1.6 BY Week_no :

```SQL

SELECT B.Week_no,
       CONCAT(ROUND(SUM(a.revenue_generated) / 1000000 , 0), ' M') AS Realised_generated,
       CONCAT(ROUND(SUM(A.revenue_realized) / 1000000 , 0), ' M') AS Realised_revenue
FROM bookings_Table A
JOIN Date_Table B ON A.check_in_date = B.Date
GROUP BY B.Week_no
ORDER BY SUM(a.revenue_generated) desc,SUM(A.revenue_realized) DESC
```

Week_no	Realised_generated	Realised_revenue
24	165 M	140 M
29	164 M	140 M
27	164 M	140 M
25	164 M	139 M
22	164 M	139 M
20	163 M	139 M
19	163 M	138 M
28	163 M	139 M
23	135 M	116 M
21	135 M	115 M
31	135 M	115 M
26	135 M	114 M
30	134 M	115 M
32	25 M	21 M


## 1.7 BY PLATFORM :
REVNEUE BY 

```SQL

SELECT booking_platform,
        CONCAT(ROUND(SUM(revenue_generated) / 1000000 , 0), ' M') AS Realised_generated,
       CONCAT(ROUND(SUM(revenue_realized) / 1000000, 0), ' M') AS Realized_revenue
FROM bookings_Table
GROUP BY booking_platform
ORDER BY SUM(revenue_generated) desc , SUM(revenue_realized) DESC
```

booking_platform	Realised_generated	Realized_revenue
others	821 M	699 M
makeyourtrip	402 M	341 M
logtrip	219 M	188 M
direct online	199 M	169 M
tripster	145 M	123 M
journey	121 M	103 M
direct offline	101 M	86 M

## 1.8 BY PROPERTY_NAME :


```SQL
SELECT h.property_name,
 CONCAT(ROUND(SUM(b.revenue_generated) / 1000000 , 0), ' M') AS Realised_generated,
       CONCAT(ROUND(SUM(b.revenue_realized) / 1000000, 0), ' M') AS Realized_revenue
FROM bookings_Table b
JOIN hotels h ON b.property_id = h.property_id
GROUP BY h.property_name
ORDER BY SUM(b.revenue_generated) desc,SUM(b.revenue_realized) DESC;

```

property_name	Realised_generated	Realized_revenue
Atliq Exotica	375 M	320 M
Atliq Palace	358 M	304 M
Atliq City	337 M	286 M
Atliq Blu	307 M	261 M
Atliq Bay	305 M	260 M
Atliq Grands	249 M	212 M
Atliq Seasons	78 M	66 M

## 1.9 BY CATEGORY :

```SQL
SELECT h.category,
    CONCAT(ROUND(SUM(b.revenue_generated) / 1000000 , 0), ' M') AS Realised_generated,
       CONCAT(ROUND(SUM(b.revenue_realized) / 1000000, 0), ' M') AS Realized_revenue
FROM bookings_Table b
JOIN hotels h ON b.property_id = h.property_id
GROUP BY h.category
ORDER BY SUM(b.revenue_generated) desc,SUM(b.revenue_realized) DESC;
```

category	Realised_generated	Realized_revenue
Luxury	1235 M	1053 M
Business	772 M	656 M

# 2nd,3rd,4th Metric 
## CAPACITY,Total_Bookings,Total_cancelled_Bookings,no_show

## 1.1 BY MONTH :

```sql
SELECT e.Month_year,
    CONCAT(ROUND(SUM(e.capacity) / 1000.0, 0), 'k') AS Total_capacity,
    CONCAT(CAST(ROUND(SUM(e.count_c) / 1000.0, 0) AS INT), 'k') AS Total_booking,
    CONCAT(CAST(ROUND(SUM(e.Cancelled_booking) / 1000.0, 0) AS INT), 'k') AS Cancelled_booking,
	    CONCAT(CAST(ROUND(SUM(e.No_show) / 1000.0, 0) AS INT), 'k') AS Total_No_show

FROM (
    SELECT A.Month_year, A.capacity, NULL AS count_c, NULL AS Cancelled_booking, null as No_show
    FROM (
        SELECT B.Month_year, SUM(A.capacity) AS capacity
        FROM aggregated_bookings_Table A
        JOIN Date_Table B ON A.check_in_date = B.Date
        GROUP BY B.Month_year
    ) A
    UNION
    SELECT B.Month_year, NULL AS capacity, B.count_c, NULL AS Cancelled_booking, null as No_show
    FROM (
        SELECT B.Month_year, COUNT(A.booking_id) AS count_c
        FROM bookings_Table A
        JOIN Date_Table B ON A.check_in_date = B.Date
        GROUP BY B.Month_year
    ) B
    UNION
    SELECT c.Month_year, NULL AS capacity, NULL AS Total_booking, c.TOTAL_CANCELLED_BOOKING AS Cancelled_booking, null as No_show
    FROM (
        SELECT B.Month_year, COUNT(*) AS TOTAL_CANCELLED_BOOKING
        FROM bookings_Table A
        JOIN Date_Table B ON A.check_in_date = B.Date
        WHERE booking_status = 'CANCELLED'
        GROUP BY B.Month_year
    ) c
  UNION
    SELECT d.Month_year, NULL AS capacity, NULL AS Total_booking, null AS Cancelled_booking, d.TOTAL_NOSHOW as No_show
    FROM (
        SELECT B.Month_year, COUNT(*) AS TOTAL_NOSHOW
        FROM bookings_Table A
        JOIN Date_Table B ON A.check_in_date = B.Date
        WHERE booking_status ='No Show'
        GROUP BY B.Month_year) D
) e
GROUP BY e.Month_year
ORDER BY Total_capacity DESC, Total_booking DESC,Total_book desc

```

#### Answer:

|Month_year|	Total_capacity   |	Total_booking	|Cancelled_booking|Total_no_show|
|----------|-------------------|-------------------|------------------|-------------|
|May 2022|	78k	|46k	|11k|2k|
|Jul 2022	|78k|	45k	|11k|2k|
|Jun 2022|	76k|	44k|	11k|2k|





## 1.3 BY CITY :
```sql

SELECT e.city,
    CONCAT(ROUND(SUM(e.capacity) / 1000.0, 0), 'k') AS Total_capacity,
    CONCAT(CAST(ROUND(SUM(e.count_c) / 1000.0, 0) AS INT), 'k') AS Total_booking,
    CONCAT(CAST(ROUND(SUM(e.Cancelled_booking) / 1000.0, 0) AS INT), 'k') AS Cancelled_booking,
    CONCAT(CAST(ROUND(SUM(e.No_show) / 1000.0, 0) AS INT), 'k') AS Total_No_show

FROM (
    SELECT A.city, A.capacity, NULL as count_c,NULL AS Cancelled_booking, null as No_show
    FROM (
        SELECT  h.city, SUM(A.capacity) as capacity
        FROM aggregated_bookings_Table A
        JOIN hotels h ON a.property_id = h.property_id
        GROUP BY  h.city) A
    UNION
    SELECT B.city, NULL as capacity, B.count_c,null as Cancelled_booking, null as No_show
    FROM (
        SELECT  h.city ,COUNT(A.booking_id) as count_c
        FROM bookings_Table A
        JOIN hotels h ON a.property_id = h.property_id
        GROUP BY  h.city) B
    UNION
	SELECT c.city, NULL as capacity, null as Total_booking, c.TOTAL_CANCELLED_BOOKING AS Cancelled_booking, null as No_show
    FROM (
        SELECT h.city, COUNT(*) AS TOTAL_CANCELLED_BOOKING
        FROM bookings_Table A
        JOIN hotels h ON a.property_id = h.property_id
		WHERE booking_status = 'CANCELLED'
        GROUP BY h.city
		) c
UNION
    SELECT d.city, NULL AS capacity, NULL AS Total_booking, null AS Cancelled_booking, d.TOTAL_NOSHOW as No_show
    FROM (
        SELECT h.city, COUNT(*) AS TOTAL_NOSHOW
        FROM bookings_Table A
        JOIN hotels h ON a.property_id = h.property_id
        WHERE booking_status ='No Show'
        GROUP BY h.city) D
) e
GROUP BY e.city
ORDER BY Total_capacity DESC, Total_booking DESC,Total_No_show desc

```
city	Total_capacity	Total_booking	Cancelled_booking	Total_No_show
Mumbai	75k	43k	11k	2k
Hyderabad	60k	35k	9k	2k
Bangalore	57k	32k	8k	2k
Delhi	40k	24k	6k	1k

## 1.4 BY Day_type :
```sql


SELECT e.Day_type,
  CONCAT(ROUND(SUM(e.capacity) / 1000.0, 0), 'k') AS Total_capacity,
    CONCAT(CAST(ROUND(SUM(e.count_c) / 1000.0, 0) AS INT), 'k') AS Total_booking,
    CONCAT(CAST(ROUND(SUM(e.Cancelled_booking) / 1000.0, 0) AS INT), 'k') AS Cancelled_booking,
    CONCAT(CAST(ROUND(SUM(e.No_show) / 1000.0, 0) AS INT), 'k') AS Total_No_show
FROM (
    SELECT A.Day_type, A.capacity, NULL as count_c,NULL AS Cancelled_booking, null as No_show
    FROM (
        SELECT  b.Day_type, SUM(A.capacity) as capacity
        FROM aggregated_bookings_Table A
        JOIN Date_Table B ON A.check_in_date = B.Date
        GROUP BY  b.Day_type) A
    UNION
    SELECT B.Day_type, NULL as capacity, B.count_c,null as Cancelled_booking, null as No_show
    FROM (
        SELECT  b.Day_type,COUNT(A.booking_id) as count_c
        FROM bookings_Table A
        JOIN Date_Table B ON A.check_in_date = B.Date
        GROUP BY  b.Day_type) B
    UNION
	SELECT  c.Day_type, NULL as capacity, null as Total_booking, c.TOTAL_CANCELLED_BOOKING AS Cancelled_booking, null as No_show
    FROM (
        SELECT   b.Day_type, COUNT(*) AS TOTAL_CANCELLED_BOOKING
        FROM bookings_Table A
        JOIN Date_Table B ON A.check_in_date = B.Date
		WHERE booking_status = 'CANCELLED'
        GROUP BY   b.Day_type
		) c
		UNION
    SELECT d.Day_type, NULL AS capacity, NULL AS Total_booking, null AS Cancelled_booking, d.TOTAL_NOSHOW as No_show
    FROM (
        SELECT  b.Day_type, COUNT(*) AS TOTAL_NOSHOW
        FROM bookings_Table A
        JOIN Date_Table B ON A.check_in_date = B.Date
        WHERE booking_status ='No Show'
        GROUP BY  b.Day_type) D
) e
GROUP BY e.Day_type
ORDER BY Total_capacity DESC, Total_booking DESC,Total_No_show desc
```

|Day_type	|Total_capacity	|Total_booking|	Cancelled_booking|Total_No_show|
|----------|-------------------|-------------------|------------------|-----------------|
Weekend	68k	50k	12k	3k
Weekday	164k	84k	21k	4k

## 1.5 BY ROOM_CLASS :

```SQL

SELECT e.room_class,
   CONCAT(ROUND(SUM(e.capacity) / 1000.0, 0), 'k') AS Total_capacity,
    CONCAT(CAST(ROUND(SUM(e.count_c) / 1000.0, 0) AS INT), 'k') AS Total_booking,
    CONCAT(CAST(ROUND(SUM(e.Cancelled_booking) / 1000.0, 0) AS INT), 'k') AS Cancelled_booking,
    CONCAT(CAST(ROUND(SUM(e.No_show) / 1000.0, 0) AS INT), 'k') AS Total_No_show
FROM (
    SELECT A.room_class, A.capacity, NULL as count_c,NULL AS Cancelled_booking, null as No_show
    FROM (
        SELECT r.room_class, SUM(A.capacity) as capacity
        FROM aggregated_bookings_Table A
        JOIN rooms r ON a.room_category = r.room_id
        GROUP BY  r.room_class) A
    UNION
    SELECT B.room_class, NULL as capacity, B.count_c,null as Cancelled_booking, null as No_show
    FROM (
        SELECT  r.room_class,COUNT(A.booking_id) as count_c
        FROM bookings_Table A
        JOIN rooms r ON a.room_category = r.room_id
        GROUP BY  r.room_class) B
    UNION
	SELECT  c.room_class, NULL as capacity, null as Total_booking, c.TOTAL_CANCELLED_BOOKING AS Cancelled_booking, null as No_show
    FROM (
        SELECT    r.room_class, COUNT(*) AS TOTAL_CANCELLED_BOOKING
        FROM bookings_Table A
        JOIN rooms r ON a.room_category = r.room_id
		WHERE booking_status = 'CANCELLED'
        GROUP BY   r.room_class
		) c
		UNION
    SELECT d.room_class, NULL AS capacity, NULL AS Total_booking, null AS Cancelled_booking, d.TOTAL_NOSHOW as No_show
    FROM (
        SELECT  r.room_class, COUNT(*) AS TOTAL_NOSHOW
        FROM bookings_Table A
       JOIN rooms r ON a.room_category = r.room_id
        WHERE booking_status ='No Show'
        GROUP BY  r.room_class) D
) e
GROUP BY e.room_class
ORDER BY Total_capacity DESC, Total_booking DESC,Total_No_show desc

```
room_class	Total_capacity	Total_booking	Cancelled_booking	Total_No_show
Elite	86k	50k	12k	2k
Standard	66k	38k	10k	2k
Premium	53k	31k	8k	2k
Presidential	27k	16k	4k	1k

## 1.6 BY Week_no :

```SQL

SELECT e.Week_no,
      CONCAT(ROUND(SUM(e.capacity) / 1000.0, 0), 'k') AS Total_capacity,
    CONCAT(CAST(ROUND(SUM(e.count_c) / 1000.0, 0) AS INT), 'k') AS Total_booking,
    CONCAT(CAST(ROUND(SUM(e.Cancelled_booking) / 1000.0, 0) AS INT), 'k') AS Cancelled_booking,
    CONCAT(CAST(ROUND(SUM(e.No_show) / 1000.0, 0) AS INT), 'k') AS Total_No_show
FROM (
    SELECT A.Week_no, A.capacity, NULL as count_c,NULL AS Cancelled_booking, null as No_show
    FROM (
        SELECT  B.Week_no, SUM(A.capacity) as capacity
        FROM aggregated_bookings_Table A
        JOIN Date_Table B ON A.check_in_date = B.Date
        GROUP BY   B.Week_no) A
    UNION
    SELECT B.Week_no, NULL as capacity, B.count_c,null as Cancelled_booking, null as No_show
    FROM (
        SELECT   B.Week_no,COUNT(A.booking_id) as count_c
        FROM bookings_Table A
        JOIN Date_Table B ON A.check_in_date = B.Date
        GROUP BY   B.Week_no) B
    UNION
	SELECT  c.Week_no, NULL as capacity, null as Total_booking, c.TOTAL_CANCELLED_BOOKING AS Cancelled_booking, null as No_show
    FROM (
        SELECT    B.Week_no, COUNT(*) AS TOTAL_CANCELLED_BOOKING
        FROM bookings_Table A
        JOIN Date_Table B ON A.check_in_date = B.Date
		WHERE booking_status = 'CANCELLED'
        GROUP BY   B.Week_no
		) c
			UNION
    SELECT d.Week_no, NULL AS capacity, NULL AS Total_booking, null AS Cancelled_booking, d.TOTAL_NOSHOW as No_show
    FROM (
        SELECT   B.Week_no, COUNT(*) AS TOTAL_NOSHOW
        FROM bookings_Table A
       JOIN Date_Table B ON A.check_in_date = B.Date
        WHERE booking_status ='No Show'
        GROUP BY   B.Week_no) D
) e
GROUP BY e.Week_no
ORDER BY Total_capacity DESC, Total_booking DESC

```

Week_no	Total_capacity	Total_booking	Cancelled_booking	Total_No_show
32	3k	2k	0k	0k
23	18k	9k	2k	0k
30	18k	9k	2k	0k
31	18k	9k	2k	0k
21	18k	9k	2k	0k
26	18k	9k	2k	0k
27	18k	11k	3k	1k
28	18k	11k	3k	1k
29	18k	11k	3k	1k
22	18k	11k	3k	1k
19	18k	11k	3k	1k
20	18k	11k	3k	1k
24	18k	11k	3k	1k
25	18k	11k	3k	1k


## 1.7 BY PLATFORM :

```SQL

SELECT D.booking_platform,
    CONCAT(CAST(ROUND(SUM(D.count_c) / 1000.0, 0) AS INT), 'k') as Total_booking,
	CONCAT(CAST(round(SUM(D.Cancelled_booking)/ 1000.0, 0)AS INT), 'k') as Cancelled_booking,
	 CONCAT(CAST(ROUND(SUM(d.No_show) / 1000.0, 0) AS INT), 'k') AS Total_No_show
FROM (
    SELECT a.booking_platform, a.count_c,null as Cancelled_booking, null as No_show
    FROM (
        SELECT   booking_platform,COUNT(booking_id) as count_c
        FROM bookings_Table 
        GROUP BY   booking_platform) a
    UNION
	SELECT b.booking_platform,  null as Total_booking, b.TOTAL_CANCELLED_BOOKING AS Cancelled_booking, null as No_show
    FROM (
        SELECT    booking_platform, COUNT(*) AS TOTAL_CANCELLED_BOOKING
        FROM bookings_Table
		WHERE booking_status = 'CANCELLED'
        GROUP BY  booking_platform
		) b
				UNION
    SELECT c.booking_platform,  NULL AS Total_booking, null AS Cancelled_booking, c.TOTAL_NOSHOW as No_show
    FROM (
        SELECT   booking_platform, COUNT(*) AS TOTAL_NOSHOW
        FROM bookings_Table A
        WHERE booking_status ='No Show'
        GROUP BY   booking_platform) c
) d
GROUP BY D.booking_platform
ORDER BY  SUM(D.count_c) DESC


```
booking_platform	Total_booking	Cancelled_booking	Total_No_show
others	55k	14k	3k
makeyourtrip	27k	7k	1k
logtrip	15k	4k	1k
direct online	13k	3k	1k
tripster	10k	2k	0k
journey	8k	2k	0k
direct offline	7k	2k	0k
## 1.8 BY PROPERTY_NAME :


```SQL
SELECT e.property_name,
   CONCAT(ROUND(SUM(e.capacity) / 1000.0, 0), 'k') AS Total_capacity,
    CONCAT(CAST(ROUND(SUM(e.count_c) / 1000.0, 0) AS INT), 'k') AS Total_booking,
    CONCAT(CAST(ROUND(SUM(e.Cancelled_booking) / 1000.0, 0) AS INT), 'k') AS Cancelled_booking,
    CONCAT(CAST(ROUND(SUM(e.No_show) / 1000.0, 0) AS INT), 'k') AS Total_No_show
FROM (
    SELECT A.property_name, A.capacity, NULL as count_c,NULL AS Cancelled_booking, null as No_show
    FROM (
        SELECT  h.property_name, SUM(A.capacity) as capacity
        FROM aggregated_bookings_Table A
        JOIN hotels h ON a.property_id = h.property_id
        GROUP BY    h.property_name) A
    UNION
    SELECT B.property_name, NULL as capacity, B.count_c,null as Cancelled_booking, null as No_show
    FROM (
        SELECT   h.property_name,COUNT(A.booking_id) as count_c
        FROM bookings_Table A
        JOIN hotels h ON a.property_id = h.property_id
        GROUP BY  h.property_name) B
    UNION
	SELECT  c.property_name, NULL as capacity, null as Total_booking, c.TOTAL_CANCELLED_BOOKING AS Cancelled_booking, null as No_show
    FROM (
        SELECT    h.property_name, COUNT(*) AS TOTAL_CANCELLED_BOOKING
        FROM bookings_Table A
        JOIN hotels h ON a.property_id = h.property_id
		WHERE booking_status = 'CANCELLED'
        GROUP BY   h.property_name
		) c
		UNION
    SELECT d.property_name, NULL AS capacity, NULL AS Total_booking, null AS Cancelled_booking, d.TOTAL_NOSHOW as No_show
    FROM (
        SELECT   h.property_name, COUNT(*) AS TOTAL_NOSHOW
        FROM bookings_Table A
       JOIN hotels h ON a.property_id = h.property_id
        WHERE booking_status ='No Show'
        GROUP BY   h.property_name) D
) e
GROUP BY e.property_name
ORDER BY Total_capacity DESC, Total_booking DESC
```

property_name	Total_capacity	Total_booking	Cancelled_booking	Total_No_show
Atliq Seasons	9k	4k	1k	0k
Atliq Exotica	41k	23k	6k	1k
Atliq Palace	39k	24k	6k	1k
Atliq City	39k	23k	6k	1k
Atliq Bay	37k	21k	5k	1k
Atliq Blu	35k	22k	5k	1k
Atliq Grands	32k	17k	4k	1k
## 1.7 BY CATEGORY :

```SQL

SELECT e.category,
     CONCAT(ROUND(SUM(e.capacity) / 1000.0, 0), 'k') AS Total_capacity,
    CONCAT(CAST(ROUND(SUM(e.count_c) / 1000.0, 0) AS INT), 'k') AS Total_booking,
    CONCAT(CAST(ROUND(SUM(e.Cancelled_booking) / 1000.0, 0) AS INT), 'k') AS Cancelled_booking,
    CONCAT(CAST(ROUND(SUM(e.No_show) / 1000.0, 0) AS INT), 'k') AS Total_No_show
FROM (
    SELECT A.category, A.capacity, NULL as count_c,NULL AS Cancelled_booking, null as No_show
    FROM (
        SELECT  h.category, SUM(A.capacity) as capacity
        FROM aggregated_bookings_Table A
        JOIN hotels h ON a.property_id = h.property_id
        GROUP BY    h.category) A
    UNION
    SELECT B.category, NULL as capacity, B.count_c,null as Cancelled_booking, null as No_show
    FROM (
        SELECT   h.category,COUNT(A.booking_id) as count_c
        FROM bookings_Table A
        JOIN hotels h ON a.property_id = h.property_id
        GROUP BY  h.category) B
    UNION
	SELECT  c.category, NULL as capacity, null as Total_booking, c.TOTAL_CANCELLED_BOOKING AS Cancelled_booking, null as No_show
    FROM (
        SELECT    h.category, COUNT(*) AS TOTAL_CANCELLED_BOOKING
        FROM bookings_Table A
        JOIN hotels h ON a.property_id = h.property_id
		WHERE booking_status = 'CANCELLED'
        GROUP BY   h.category
		) c
	UNION
    SELECT d.category, NULL AS capacity, NULL AS Total_booking, null AS Cancelled_booking, d.TOTAL_NOSHOW as No_show
    FROM (
        SELECT   h.category, COUNT(*) AS TOTAL_NOSHOW
        FROM bookings_Table A
       JOIN hotels h ON a.property_id = h.property_id
        WHERE booking_status ='No Show'
        GROUP BY   h.category) D
) e
GROUP BY e.category
ORDER BY Total_capacity DESC, Total_booking DESC

```

category	Total_capacity	Total_booking	Cancelled_booking	Total_No_show
Business	87k	51k	13k	2k
Luxury	145k	84k	21k	4k


# OCCUPANCY %
## 1.2 BY MONTH :
```sql
SELECT B.Month_year, 
    CONCAT(ROUND(SUM(successful_bookings) / SUM(capacity) * 100, 1), '%') AS Occupancy_percent
FROM aggregated_bookings_Table A
JOIN Date_Table B
ON A.check_in_date = B.Date
GROUP BY B.Month_year
ORDER BY SUM(successful_bookings) / SUM(capacity) DESC 
```
#### Answer:
|Month_year|	Occupancy_percent |
|----------|-------------------|
|May 2022	|58.5%|
|Jul 2022	|57.6%|
|Jun 2022	|57.5%|

	
## 1.3 BY CITY :
```sql

SELECT h.city,
       CONCAT(ROUND(SUM(successful_bookings) / SUM(capacity) * 100, 1), '%') AS Occupancy_percent
FROM aggregated_bookings_Table A
JOIN hotels h ON a.property_id = h.property_id
GROUP BY h.city
ORDER BY SUM(successful_bookings) / SUM(capacity) DESC 

```
|city	|Occupancy_percent|
|--------|-----------|
|Delhi	|60.5%|
|Hyderabad|	58.1%|
|Mumbai	|57.9%|
|Bangalore|	55.8%|

## 1.4 BY Day_type :
```sql

SELECT 
      b.Day_type,
       CONCAT(ROUND(SUM(A.revenue_realized) / 1000000 , 0), ' M') AS Realised_revenue
FROM bookings_Table A
JOIN Date_Table B ON A.check_in_date = B.Date
GROUP BY  b.Day_type
ORDER BY  b.Day_type
```

|Day_type	|  Realised_revenue|
|----------|-------------------|
|Weekday	 | 1070 M|
|Weekend	|  639 M|

## 1.5 BY ROOM_CLASS :

```SQL
SELECT r.room_class,
       CONCAT(ROUND(SUM(successful_bookings) / SUM(capacity) * 100, 1), '%') AS Occupancy_percent
FROM aggregated_bookings_Table b
JOIN rooms r ON b.room_category = r.room_id
GROUP BY r.room_class;

```

|room_class	|Occupancy_percent|
|--------|-----------|
|Elite	|57.6%|
|Premium	|57.6%|
|Presidential|	59.2%|
|Standard	|57.9%|

## 1.6 BY Week_no :

```SQL

SELECT B.Week_no,
       CONCAT(ROUND(SUM(successful_bookings) / SUM(capacity) * 100, 1), '%') AS Occupancy_percent
FROM aggregated_bookings_Table A
JOIN Date_Table B ON A.check_in_date = B.Date
GROUP BY B.Week_no
having B.Week_no != '32'
ORDER BY SUM(successful_bookings) / SUM(capacity) DESC
```

|Week_no	|Occupancy_percent|
|--------|-----------|
|24	|62.4%|
|29|	62.3%|
|19	|62%|
|27	|61.9%|
|20	|61.9%|
|25	|61.8%|
|22	|61.8%|
|28	|61.8%|
|23	|51.4%|
|21	|51.1%|
|31	|51%|
|30	|51%|
|26|	51%|


## 1.8 BY PROPERTY_NAME :


```SQL
SELECT h.property_name,
       CONCAT(ROUND(SUM(successful_bookings) / SUM(capacity) * 100, 1), '%') AS Occupancy_percent
FROM aggregated_bookings_Table A
JOIN hotels h ON a.property_id = h.property_id
GROUP BY h.property_name
ORDER BY SUM(successful_bookings) / SUM(capacity) DESC


```
|property_name|	Occupancy_percent|
|--------|-----------|
|Atliq Blu|	62%|
|Atliq Palace|	60%|
|Atliq City|	59.5%|
|Atliq Bay	|58.4%|
|Atliq Exotica|	57.3%|
|Atliq Grands|	52.6%|
|Atliq Seasons|	44.6%|

## 1.7 BY CATEGORY :

```SQL
SELECT h.category,
       CONCAT(ROUND(SUM(successful_bookings) / SUM(capacity) * 100, 1), '%') AS Occupancy_percent
FROM aggregated_bookings_Table A
JOIN hotels h ON a.property_id = h.property_id
GROUP BY h.category
ORDER BY SUM(successful_bookings) / SUM(capacity) DESC
```

|category	|Occupancy_percent|
|--------|-----------|
|Business|	58.2%|
|Luxury|	57.7%|


# 1st Metric 
## REVENUE
## 1.1  Revenue :

```` sql
SELECT
  CONCAT(ROUND(SUM(revenue_realized) / 1000000 , 0), ' M') AS Revenue
FROM bookings_Table;
````
#### Answer:

```
Revenue 
 1709 M
```

## 1.2 BY MONTH :
```sql
SELECT A.Month_year, ROUND(SUM(revenue) / SUM(capacity_total), 0) AS RevPAR
FROM (
  SELECT check_in_date, SUM(revenue_realized) AS revenue
  FROM bookings_Table
  GROUP BY check_in_date) AS revenue_table,
(SELECT check_in_date, SUM(capacity) AS capacity_total
  FROM aggregated_bookings_Table
  GROUP BY check_in_date) AS capacity_table,
Date_Table A
WHERE A.Date = revenue_table.check_in_date
  AND A.Date = capacity_table.check_in_date
GROUP BY A.Month_year
ORDER BY RevPAR DESC
```
#### Answer:
|Month_year|	RevPAR|
|--------|-----------|
|Jul 2022	|7310|
|Jun 2022	|7304|
|May 2022|	7426|

## 1.3 BY CITY :
```sql


SELECT h.city, ROUND(SUM(revenue) / SUM(capacity_total), 0) AS RevPAR
FROM (
  SELECT property_id, SUM(revenue_realized) AS revenue
  FROM bookings_Table
  GROUP BY property_id) AS revenue_table,
(SELECT property_id, SUM(capacity) AS capacity_total
  FROM aggregated_bookings_Table
  GROUP BY property_id) AS capacity_table,
hotels h
WHERE h.property_id = revenue_table.property_id
  AND h.property_id = capacity_table.property_id
GROUP BY h.city
ORDER BY RevPAR DESC

```

|city	|RevPAR|
|--------|-----------|
|Mumbai	|8907|
|Delhi	|7359|
|Bangalore	|7323|
|Hyderabad|	5414|


## 1.4 BY Day_type :
```sql

SELECT A.Day_type, ROUND(SUM(revenue) / SUM(capacity_total), 0) AS RevPAR
FROM (
  SELECT check_in_date, SUM(revenue_realized) AS revenue
  FROM bookings_Table
  GROUP BY check_in_date) AS revenue_table,
(SELECT check_in_date, SUM(capacity) AS capacity_total
  FROM aggregated_bookings_Table
  GROUP BY check_in_date) AS capacity_table,
Date_Table A
WHERE A.Date = revenue_table.check_in_date
  AND A.Date = capacity_table.check_in_date
GROUP BY A.Day_type
ORDER BY RevPAR DESC
```

|Day_type|	RevPAR|
|--------|-----------|
|Weekend|	9363|
|Weekday|	6510|
## 1.5 BY ROOM_CLASS :

```SQL

SELECT r.room_class, ROUND(SUM(revenue) / SUM(capacity_total), 0) AS RevPAR
FROM (
  SELECT room_category, SUM(revenue_realized) AS revenue
  FROM bookings_Table
  GROUP BY room_category) AS revenue_table,
(SELECT room_category, SUM(capacity) AS capacity_total
  FROM aggregated_bookings_Table
  GROUP BY room_category) AS capacity_table,
rooms r
WHERE r.room_id = revenue_table.room_category
  AND r.room_id = capacity_table.room_category
GROUP BY r.room_class
ORDER BY RevPAR DESC

```

|room_class	|RevPAR|
|--------|-----------|
|Presidential |	13882|
|Premium|	8706|
|Elite	|6520|
|Standard	|4661|


## 1.8 BY PROPERTY_NAME :


```SQL
SELECT  h.property_name, ROUND(SUM(revenue) / SUM(capacity_total), 0) AS RevPAR
FROM (
  SELECT property_id, SUM(revenue_realized) AS revenue
  FROM bookings_Table
  GROUP BY property_id) AS revenue_table,
(SELECT property_id, SUM(capacity) AS capacity_total
  FROM aggregated_bookings_Table
  GROUP BY property_id) AS capacity_table,
hotels h
WHERE h.property_id = revenue_table.property_id
  AND h.property_id = capacity_table.property_id
GROUP BY h.property_name
ORDER BY RevPAR DESC

```

|property_name|	RevPAR|
|--------|-----------|
|Atliq Exotica|	7824|
|Atliq Palace	|7723|
|Atliq Blu	|7422|
|Atliq Seasons|	7410|
|Atliq City	|7293|
|Atliq Bay	|7102|
|Atliq Grands	|6532|

## 1.9 BY CATEGORY :

```SQL
SELECT  h.category, ROUND(SUM(revenue) / SUM(capacity_total), 0) AS RevPAR
FROM (
  SELECT property_id, SUM(revenue_realized) AS revenue
  FROM bookings_Table
  GROUP BY property_id) AS revenue_table,
(SELECT property_id, SUM(capacity) AS capacity_total
  FROM aggregated_bookings_Table
  GROUP BY property_id) AS capacity_table,
hotels h
WHERE h.property_id = revenue_table.property_id
  AND h.property_id = capacity_table.property_id
GROUP BY h.category
ORDER BY RevPAR DESC

```

|category|	RevPAR|
|------------|-------------|
|Business	|7498|
|Luxury	|7256|


# AVERAGE RATINGS


## 1.1  Revenue :

```` sql
SELECT ROUND(AVG(ratings_given), 2) as AVERAGE_RATINGS FROM bookings_Table 

````
#### Answer:

```
Revenue 
 1709 M
```

## 1.2 BY MONTH :
```sql
SELECT B.Month_year, 
   ROUND(AVG(ratings_given), 2) as AVERAGE_RATINGS 
FROM bookings_Table a
JOIN Date_Table B
ON A.check_in_date = B.Date
GROUP BY B.Month_year
ORDER BY AVG(ratings_given) DESC 
```
#### Answer:
|Month_year|	AVERAGE_RATINGS|
|------------|-------------|
|May 2022	|3.63|
|Jun 2022	|3.62|
|Jul 2022|	3.62|

## 1.3 BY CITY :
```sql

SELECT h.city, 
   ROUND(AVG(ratings_given), 2) as AVERAGE_RATINGS 
FROM bookings_Table a
JOIN hotels h ON A.property_id = h.property_id
GROUP BY h.city
ORDER BY AVG(ratings_given) DESC 
```

|city	|AVERAGE_RATINGS|
|------------|-------------|
|Delhi	|3.78|
|Hyderabad|	3.66|
|Mumbai	|3.65|
|Bangalore|	3.41|


## 1.5 BY ROOM_CLASS :

```SQL
SELECT r.room_class, 
   ROUND(AVG(ratings_given), 2) as AVERAGE_RATINGS 
FROM bookings_Table a
JOIN rooms r ON A.room_category = r.room_id
GROUP BY  r.room_class
ORDER BY AVG(ratings_given) DESC 

```

|room_class|	AVERAGE_RATINGS|
|------------|-------------|
|Presidential|	3.69|
|Standard	|3.63|
|Elite|	3.6|
|Premium	|3.59|

## 1.6 BY Week_no :

```SQL
SELECT B.Week_no, 
   ROUND(AVG(ratings_given), 2) as AVERAGE_RATINGS 
FROM bookings_Table a
JOIN Date_Table B ON A.check_in_date = B.Date
GROUP BY B.Week_no
ORDER BY AVG(ratings_given) DESC 

```

|Week_no|	AVERAGE_RATINGS|
|------------|-------------|
|19	|3.65|
|23	|3.65|
|31	|3.64|
|27	|3.63|
|25|	3.63|
|21|	3.62|
|20|	3.62|
|28|	3.62|
|32|	3.62|
|29|	3.61|
|26|	3.6|
|24|	3.6|
|22|	3.59|
|30	|3.59|

## 1.7 BY PLATFORM :
REVNEUE BY 

```SQL

SELECT booking_platform, 
   ROUND(AVG(ratings_given), 2) as AVERAGE_RATINGS 
FROM bookings_Table 
GROUP BY booking_platform
ORDER BY AVG(ratings_given) DESC

```

|booking_platform|	AVERAGE_RATINGS|
|---------|----------|
|journey	|3.63|
|logtrip	|3.62|
|direct offline|	3.62|
|tripster|	3.62|
|others	|3.62|
|makeyourtrip|	3.62|
|direct online|	3.61|

## 1.8 BY PROPERTY_NAME :


```SQL
SELECT h.property_name, 
   ROUND(AVG(ratings_given), 2) as AVERAGE_RATINGS 
FROM bookings_Table a
JOIN hotels h ON A.property_id = h.property_id
GROUP BY h.property_name
ORDER BY AVG(ratings_given) DESC 

```

|property_name	|AVERAGE_RATINGS|
|---------|----------|
|Atliq Blu|	3.96|
|Atliq Palace|	3.75|
|Atliq Bay	|3.71|
|Atliq City|	3.69|
|Atliq Exotica|	3.62|
|Atliq Grands	|3.1|
|Atliq Seasons|	2.29|

## 1.9 BY CATEGORY :

```SQL
SELECT h.category, 
   ROUND(AVG(ratings_given), 2) as AVERAGE_RATINGS 
FROM bookings_Table a
JOIN hotels h ON A.property_id = h.property_id
GROUP BY h.category
ORDER BY AVG(ratings_given) DESC 
```

|category	|AVERAGE_RATINGS|
|---------|----------|
|Luxury	|3.62|
|Business|	3.61|












  ## CancELLATION%


## 1.2 BY MONTH :
```sql
  SELECT
  total_bookings.month,
  concat( ROUND((CAST(cancelled_bookings.TOTAL_CANCELLED_BOOKING AS FLOAT) / total_bookings.Total_Bookings) * 100, 2), '%' ) AS Cancellation_Percentage
FROM
  (SELECT
    date_table.Month_year AS month,
    COUNT(*) AS TOTAL_CANCELLED_BOOKING
    FROM
    bookings_Table
  JOIN
    date_table ON date_table.date = bookings_Table.check_in_date
  WHERE
    booking_status = 'CANCELLED'
  GROUP BY
  date_table.Month_year
  ) AS cancelled_bookings
JOIN
  (SELECT
   date_table.Month_year AS month,
    COUNT(booking_id) AS Total_Bookings
  FROM
    bookings_Table
  JOIN
    Date_Table ON date_table.date = bookings_Table.check_in_date
  GROUP BY
     date_table.Month_year
  ) AS total_bookings ON cancelled_bookings.month = total_bookings.month
```
#### Answer:
month	Cancellation_Percentage
Jul 2022	24.46%
Jun 2022	25.09%
May 2022	24.95%

## 1.3 BY CITY :
```sql

  SELECT
  total_bookings.city,
  concat( ROUND((CAST(cancelled_bookings.TOTAL_CANCELLED_BOOKING AS FLOAT) / total_bookings.Total_Bookings) * 100, 2), '%' ) AS Cancellation_Percentage
FROM
  (SELECT
   h.city AS city,
    COUNT(*) AS TOTAL_CANCELLED_BOOKING
    FROM
    bookings_Table b
JOIN hotels h ON b.property_id = h.property_id
  WHERE
    booking_status = 'CANCELLED'
  GROUP BY
   h.city 
  ) AS cancelled_bookings
JOIN
  (SELECT
   h.city AS city,
    COUNT(booking_id) AS Total_Bookings
  FROM
    bookings_Table b
JOIN hotels h ON b.property_id = h.property_id
  GROUP BY
     h.city
  ) AS total_bookings ON cancelled_bookings.city = total_bookings.city

```

city	Cancellation_Percentage
Bangalore	24.99%
Delhi	25.06%
Hyderabad	24.63%
Mumbai	24.75%

## 1.4 BY Day_type :
```sql
  SELECT
  total_bookings.day_type,
  concat( ROUND((CAST(cancelled_bookings.TOTAL_CANCELLED_BOOKING AS FLOAT) / total_bookings.Total_Bookings) * 100, 2), '%' ) AS Cancellation_Percentage
FROM
  (SELECT
    d.Day_type AS day_type,
    COUNT(*) AS TOTAL_CANCELLED_BOOKING
    FROM
    bookings_Table b
  JOIN
    date_table d ON d.date = b.check_in_date
  WHERE
    booking_status = 'CANCELLED'
  GROUP BY
  d.Day_type
  ) AS cancelled_bookings
JOIN
  (SELECT
   d.Day_type AS day_type,
    COUNT(booking_id) AS Total_Bookings
  FROM
    bookings_Table b
  JOIN
    Date_Table d ON d.date = b.check_in_date
  GROUP BY
     d.Day_type
  ) AS total_bookings ON cancelled_bookings.day_type = total_bookings.day_type

```

day_type	Cancellation_Percentage
Weekday	25.04%
Weekend	24.48%

## 1.5 BY ROOM_CLASS :

```SQL
  SELECT
  total_bookings.room_class,
  concat( ROUND((CAST(cancelled_bookings.TOTAL_CANCELLED_BOOKING AS FLOAT) / total_bookings.Total_Bookings) * 100, 2), '%' ) AS Cancellation_Percentage
FROM
  (SELECT
    r.room_class AS room_class,
    COUNT(*) AS TOTAL_CANCELLED_BOOKING
    FROM
    bookings_Table b
  JOIN rooms r ON b.room_category = r.room_id
  WHERE
    booking_status = 'CANCELLED'
  GROUP BY
 r.room_class
  ) AS cancelled_bookings
JOIN
  (SELECT
   r.room_class AS room_class,
    COUNT(booking_id) AS Total_Bookings
  FROM
    bookings_Table b
JOIN rooms r ON b.room_category = r.room_id
  GROUP BY
    r.room_class
  ) AS total_bookings ON cancelled_bookings.room_class = total_bookings.room_class

```
room_class	Cancellation_Percentage
Elite	24.96%
Premium	24.88%
Presidential	24.44%
Standard	24.79%
## 1.6 BY Week_no :

```SQL

 SELECT
  total_bookings.week,
  concat( ROUND((CAST(cancelled_bookings.TOTAL_CANCELLED_BOOKING AS FLOAT) / total_bookings.Total_Bookings) * 100, 2), '%' ) AS Cancellation_Percentage
FROM
  (SELECT
    d.Week_no AS week,
    COUNT(*) AS TOTAL_CANCELLED_BOOKING
    FROM
    bookings_Table b
  JOIN
    date_table d ON d.date = b.check_in_date
  WHERE
    booking_status = 'CANCELLED'
  GROUP BY
  d.Week_no
  ) AS cancelled_bookings
JOIN
  (SELECT
   d.Week_no AS week,
    COUNT(booking_id) AS Total_Bookings
  FROM
    bookings_Table b
  JOIN
    Date_Table d ON d.date = b.check_in_date
  GROUP BY
     d.Week_no
  ) AS total_bookings ON cancelled_bookings.week = total_bookings.week
```
week	Cancellation_Percentage
19	25.34%
20	24.74%
21	24.62%
22	25.35%
23	24.45%
24	25.33%
25	25.11%
26	25.5%
27	24.55%
28	24.18%
29	24.8%
30	24.5%
31	24.31%
32	23.99%
## 1.7 BY PLATFORM :
REVNEUE BY 

```SQL

  SELECT
  total_bookings.platform,
  concat( ROUND((CAST(cancelled_bookings.TOTAL_CANCELLED_BOOKING AS FLOAT) / total_bookings.Total_Bookings) * 100, 2), '%' ) AS Cancellation_Percentage
FROM
  (SELECT
      booking_platform AS platform,
    COUNT(*) AS TOTAL_CANCELLED_BOOKING
    FROM
    bookings_Table b
  WHERE
    booking_status = 'CANCELLED'
  GROUP BY
 booking_platform
  ) AS cancelled_bookings
JOIN
  (SELECT
   booking_platform AS platform,
    COUNT(booking_id) AS Total_Bookings
  FROM
    bookings_Table 
  GROUP BY
   booking_platform
  ) AS total_bookings ON cancelled_bookings.platform = total_bookings.platform
```

platform	Cancellation_Percentage
others	24.88%
journey	24.78%
direct online	24.99%
direct offline	24.49%
tripster	24.99%
logtrip	24.3%
makeyourtrip	24.99%

## 1.8 BY PROPERTY_NAME :


```SQL
SELECT
  total_bookings.property_name,
  concat( ROUND((CAST(cancelled_bookings.TOTAL_CANCELLED_BOOKING AS FLOAT) / total_bookings.Total_Bookings) * 100, 2), '%' ) AS Cancellation_Percentage
FROM
  (SELECT
    H.property_name AS property_name,
    COUNT(*) AS TOTAL_CANCELLED_BOOKING
    FROM
    bookings_Table b
  JOIN hotels h ON b.property_id = h.property_id
  WHERE
    booking_status = 'CANCELLED'
  GROUP BY
  H.property_name
  ) AS cancelled_bookings
JOIN
  (SELECT
   h.property_name AS property_name,
    COUNT(booking_id) AS Total_Bookings
  FROM
    bookings_Table  B
  JOIN hotels h ON b.property_id = h.property_id
  GROUP BY
     H.property_name
  ) AS total_bookings ON cancelled_bookings.property_name = total_bookings.property_name

```

property_name	Cancellation_Percentage
Atliq Bay	24.84%
Atliq Blu	24.65%
Atliq City	24.92%
Atliq Exotica	24.37%
Atliq Grands	25.08%
Atliq Palace	25.18%
Atliq Seasons	24.79%

## 1.9 BY CATEGORY :

```SQL

  SELECT
  total_bookings.category,
  concat( ROUND((CAST(cancelled_bookings.TOTAL_CANCELLED_BOOKING AS FLOAT) / total_bookings.Total_Bookings) * 100, 2), '%' ) AS Cancellation_Percentage
FROM
  (SELECT
    H.category AS category,
    COUNT(*) AS TOTAL_CANCELLED_BOOKING
    FROM
    bookings_Table b
  JOIN hotels h ON b.property_id = h.property_id
  WHERE
    booking_status = 'CANCELLED'
  GROUP BY
  H.category
  ) AS cancelled_bookings
JOIN
  (SELECT
   h.category AS category,
    COUNT(booking_id) AS Total_Bookings
  FROM
    bookings_Table  B
  JOIN hotels h ON b.property_id = h.property_id
  GROUP BY
     H.category
  ) AS total_bookings ON cancelled_bookings.category = total_bookings.category
```

category	Cancellation_Percentage
Business	25.03%
Luxury	24.71% 
