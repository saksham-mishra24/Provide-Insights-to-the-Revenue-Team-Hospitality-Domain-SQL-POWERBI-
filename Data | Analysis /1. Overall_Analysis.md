# 1st Metric 
## REVENUE
## 1.1  Revenue :

```` sql
SELECT
  CONCAT(ROUND(SUM(revenue_realized) / 1000000 , 0), ' M') AS Revenue
FROM bookings_Table;
````
#### Answer:

```
Revenue 
 1709 M
```

## 1.2 BY MONTH :
```sql
SELECT B.Month_year, 
CONCAT(ROUND(SUM(A.revenue_realized) / 1000000 , 0), ' M') AS Realised_revenue
FROM bookings_Table A
JOIN Date_Table B
ON A.check_in_date = B.Date
GROUP BY B.Month_year
ORDER BY Realised_revenue DESC 
```
#### Answer:
|Month_year|	Realised_revenue |
|----------|-------------------|
|May 2022	|582 M|
|Jul 2022	|573 M|
|Jun 2022	|554 M|

## 1.3 BY CITY :
```sql

SELECT h.city,
       CONCAT(ROUND(SUM(b.revenue_realized) / 1000000, 0), ' M') AS Realized_revenue
FROM bookings_Table b
JOIN hotels h ON b.property_id = h.property_id
GROUP BY h.city
ORDER BY SUM(b.revenue_realized) DESC;

```

|city	|Realised_revenue|
|----------|-------------------|
|Mumbai	|669 M|
|Bangalore	|420 M|
|Hyderabad|	325 M|
|Delhi|	295 M|


## 1.4 BY Day_type :
```sql

SELECT 
      b.Day_type,
       CONCAT(ROUND(SUM(A.revenue_realized) / 1000000 , 0), ' M') AS Realised_revenue
FROM bookings_Table A
JOIN Date_Table B ON A.check_in_date = B.Date
GROUP BY  b.Day_type
ORDER BY  b.Day_type
```

|Day_type	|  Realised_revenue|
|----------|-------------------|
|Weekday	 | 1070 M|
|Weekend	|  639 M|

## 1.5 BY ROOM_CLASS :

```SQL
SELECT r.room_class,
       CONCAT(ROUND(SUM(b.revenue_realized) / 1000000, 0), ' M') AS Realized_revenue
FROM bookings_Table b
JOIN rooms r ON b.room_category = r.room_id
GROUP BY r.room_class;

```

|room_class	|Realised_revenue|
|----------|-------------------|
|Elite	               | 560 M|
|Premium	   |     462 M|
|Presidential	|377 M|
|Standard	   |     310 M|

## 1.6 BY Week_no :

```SQL

SELECT B.Week_no,
       CONCAT(ROUND(SUM(A.revenue_realized) / 1000000 , 0), ' M') AS Realised_revenue
FROM bookings_Table A
JOIN Date_Table B ON A.check_in_date = B.Date
GROUP BY B.Week_no
ORDER BY SUM(A.revenue_realized) DESC
```

|Week_no|	Realised_revenue|
|----------|-------------------|
|29|	140 M|
|24|	140 M|
|27|	140 M|
|20	|139 M|
|28|	139 M|
|22|	139 M|
|25|	139 M|
|19|	138 M|
|23	|116 M|
|31|	115 M|
|21	|115 M|
|30	|115 M|
|26|	114 M|
|32	|21 M|


## 1.7 BY PLATFORM :
REVNEUE BY 

```SQL

SELECT booking_platform,
       CONCAT(ROUND(SUM(revenue_realized) / 1000000, 0), ' M') AS Realized_revenue
FROM bookings_Table
GROUP BY booking_platform
ORDER BY SUM(revenue_realized) DESC

```

|booking_platform|	Realized_revenue|
|----------|-------------------|
|others	|699 M|
|makeyourtrip	|341 M|
|logtrip	|188 M|
|direct online	|169 M|
|tripster|	123 M|
|journey	|103 M|
|direct offline	|86 M|

## 1.8 BY PROPERTY_NAME :


```SQL
SELECT h.property_name,
       CONCAT(ROUND(SUM(b.revenue_realized) / 1000000, 0), ' M') AS Realized_revenue
FROM bookings_Table b
JOIN hotels h ON b.property_id = h.property_id
GROUP BY h.property_name
ORDER BY SUM(b.revenue_realized) DESC;

```

|property_name|	Realized_revenue|
|----------|-------------------|
|Atliq Exotica|	320 M|
|Atliq Palace|	304 M|
|Atliq City|	286 M|
|Atliq Blu|	261 M|
|Atliq Bay	|260 M|
|Atliq Grands|	212 M|
|Atliq Seasons|	66 M|

## 1.9 BY CATEGORY :

```SQL
SELECT h.category,
       CONCAT(ROUND(SUM(b.revenue_realized) / 1000000, 0), ' M') AS Realized_revenue
FROM bookings_Table b
JOIN hotels h ON b.property_id = h.property_id
GROUP BY h.category
ORDER BY SUM(b.revenue_realized) DESC;
```

|category	|Realised_revenue|
|----------|-------------------|
|Luxury|	1053 M|
|Business	|656 M|

# 2nd,3rd,4th Metric 
## CAPACITY,Total_Bookings,Total_cancelled_Bookings

## 1.1 BY MONTH :

```sql
SELECT D.Month_year,
    CONCAT(ROUND(SUM(D.capacity) / 1000.0, 0), 'k') AS Total_capacity,
    CONCAT(CAST(ROUND(SUM(D.count_c) / 1000.0, 0) AS INT), 'k') AS Total_booking,
    CONCAT(CAST(ROUND(SUM(D.Cancelled_booking) / 1000.0, 0) AS INT), 'k') AS Cancelled_booking
FROM (
    SELECT A.Month_year, A.capacity, NULL AS count_c, NULL AS Cancelled_booking
    FROM (
        SELECT B.Month_year, SUM(A.capacity) AS capacity
        FROM aggregated_bookings_Table A
        JOIN Date_Table B ON A.check_in_date = B.Date
        GROUP BY B.Month_year
    ) A
    UNION
    SELECT B.Month_year, NULL AS capacity, B.count_c, NULL AS Cancelled_booking
    FROM (
        SELECT B.Month_year, COUNT(A.booking_id) AS count_c
        FROM bookings_Table A
        JOIN Date_Table B ON A.check_in_date = B.Date
        GROUP BY B.Month_year
    ) B
    UNION
    SELECT c.Month_year, NULL AS capacity, NULL AS Total_booking, c.TOTAL_CANCELLED_BOOKING AS Cancelled_booking
    FROM (
        SELECT B.Month_year, COUNT(*) AS TOTAL_CANCELLED_BOOKING
        FROM bookings_Table A
        JOIN Date_Table B ON A.check_in_date = B.Date
        WHERE booking_status = 'CANCELLED'
        GROUP BY B.Month_year
    ) c
) D
GROUP BY D.Month_year
ORDER BY Total_capacity DESC, Total_booking DESC;
```

#### Answer:

|Month_year|	Total_capacity   |	Total_booking	|Cancelled_booking|
|----------|-------------------|-------------------|------------------|
|May 2022|	78k	|46k	|11k|
|Jul 2022	|78k|	45k	|11k|
|Jun 2022|	76k|	44k|	11k|



## 1.3 BY CITY :
```sql

SELECT D.city,
    CONCAT(round(SUM(D.capacity)/1000.0 ,0),'k')  as Total_capacity,   
    CONCAT(CAST(ROUND(SUM(D.count_c) / 1000.0, 0) AS INT), 'k') as Total_booking,
	CONCAT(CAST(round(SUM(D.Cancelled_booking)/ 1000.0, 0)AS INT), 'k') as Cancelled_booking
FROM (
    SELECT A.city, A.capacity, NULL as count_c,NULL AS Cancelled_booking
    FROM (
        SELECT  h.city, SUM(A.capacity) as capacity
        FROM aggregated_bookings_Table A
        JOIN hotels h ON a.property_id = h.property_id
        GROUP BY  h.city) A
    UNION
    SELECT B.city, NULL as capacity, B.count_c,null as Cancelled_booking
    FROM (
        SELECT  h.city ,COUNT(A.booking_id) as count_c
        FROM bookings_Table A
        JOIN hotels h ON a.property_id = h.property_id
        GROUP BY  h.city) B
    UNION
	SELECT c.city, NULL as capacity, null as Total_booking, c.TOTAL_CANCELLED_BOOKING AS Cancelled_booking
    FROM (
        SELECT h.city, COUNT(*) AS TOTAL_CANCELLED_BOOKING
        FROM bookings_Table A
        JOIN hotels h ON a.property_id = h.property_id
		WHERE booking_status = 'CANCELLED'
        GROUP BY h.city
		) c
		) D
GROUP BY D.city
ORDER BY Total_capacity DESC, Total_booking DESC


```

|city	|Total_capacity	|Total_booking	|Cancelled_booking|
|----------|-------------------|-------------------|------------------|
|Mumbai	|75k	|43k	|11k|
|Hyderabad	|60k	|35k	9k|
|Bangalore|	57k|	32k|	8k|
|Delhi|	40k|	24k|	6k|


## 1.4 BY Day_type :
```sql

SELECT D.Day_type,
    CONCAT(round(SUM(D.capacity)/1000.0 ,0),'k')  as Total_capacity,   
    CONCAT(CAST(ROUND(SUM(D.count_c) / 1000.0, 0) AS INT), 'k') as Total_booking,
	CONCAT(CAST(round(SUM(D.Cancelled_booking)/ 1000.0, 0)AS INT), 'k') as Cancelled_booking
FROM (
    SELECT A.Day_type, A.capacity, NULL as count_c,NULL AS Cancelled_booking
    FROM (
        SELECT  b.Day_type, SUM(A.capacity) as capacity
        FROM aggregated_bookings_Table A
        JOIN Date_Table B ON A.check_in_date = B.Date
        GROUP BY  b.Day_type) A
    UNION
    SELECT B.Day_type, NULL as capacity, B.count_c,null as Cancelled_booking
    FROM (
        SELECT  b.Day_type,COUNT(A.booking_id) as count_c
        FROM bookings_Table A
        JOIN Date_Table B ON A.check_in_date = B.Date
        GROUP BY  b.Day_type) B
    UNION
	SELECT  c.Day_type, NULL as capacity, null as Total_booking, c.TOTAL_CANCELLED_BOOKING AS Cancelled_booking
    FROM (
        SELECT   b.Day_type, COUNT(*) AS TOTAL_CANCELLED_BOOKING
        FROM bookings_Table A
        JOIN Date_Table B ON A.check_in_date = B.Date
		WHERE booking_status = 'CANCELLED'
        GROUP BY   b.Day_type
		) c
		) D
GROUP BY D.Day_type
ORDER BY Total_capacity DESC, Total_booking DESC
```

|Day_type	|Total_capacity	|Total_booking|	Cancelled_booking|
|----------|-------------------|-------------------|------------------|
|Weekend	|68k|	50k	|12k|
|Weekday|	164k	|84k|21k|

## 1.5 BY ROOM_CLASS :

```SQL
SELECT D.room_class,
    CONCAT(round(SUM(D.capacity)/1000.0 ,0),'k')  as Total_capacity,   
    CONCAT(CAST(ROUND(SUM(D.count_c) / 1000.0, 0) AS INT), 'k') as Total_booking,
	CONCAT(CAST(round(SUM(D.Cancelled_booking)/ 1000.0, 0)AS INT), 'k') as Cancelled_booking
FROM (
    SELECT A.room_class, A.capacity, NULL as count_c,NULL AS Cancelled_booking
    FROM (
        SELECT r.room_class, SUM(A.capacity) as capacity
        FROM aggregated_bookings_Table A
        JOIN rooms r ON a.room_category = r.room_id
        GROUP BY  r.room_class) A
    UNION
    SELECT B.room_class, NULL as capacity, B.count_c,null as Cancelled_booking
    FROM (
        SELECT  r.room_class,COUNT(A.booking_id) as count_c
        FROM bookings_Table A
        JOIN rooms r ON a.room_category = r.room_id
        GROUP BY  r.room_class) B
    UNION
	SELECT  c.room_class, NULL as capacity, null as Total_booking, c.TOTAL_CANCELLED_BOOKING AS Cancelled_booking
    FROM (
        SELECT    r.room_class, COUNT(*) AS TOTAL_CANCELLED_BOOKING
        FROM bookings_Table A
        JOIN rooms r ON a.room_category = r.room_id
		WHERE booking_status = 'CANCELLED'
        GROUP BY   r.room_class
		) c
		) D
GROUP BY D.room_class
ORDER BY Total_capacity DESC, Total_booking DESC

```

|room_class	|Total_capacity	|Total_booking	|Cancelled_booking
|----------|-------------------|-------------------|------------------|
|Elite|	86k	|50k|	12k|
|Standard	|66k	|38k	|10k|
|Premium|	53k|	31k|	8k|
|Presidential|	27k	|16k|	4k|

## 1.6 BY Week_no :

```SQL

SELECT D.Week_no,
    CONCAT(round(SUM(D.capacity)/1000.0 ,0),'k')  as Total_capacity,   
    CONCAT(CAST(ROUND(SUM(D.count_c) / 1000.0, 0) AS INT), 'k') as Total_booking,
	CONCAT(CAST(round(SUM(D.Cancelled_booking)/ 1000.0, 0)AS INT), 'k') as Cancelled_booking
FROM (
    SELECT A.Week_no, A.capacity, NULL as count_c,NULL AS Cancelled_booking
    FROM (
        SELECT  B.Week_no, SUM(A.capacity) as capacity
        FROM aggregated_bookings_Table A
        JOIN Date_Table B ON A.check_in_date = B.Date
        GROUP BY   B.Week_no) A
    UNION
    SELECT B.Week_no, NULL as capacity, B.count_c,null as Cancelled_booking
    FROM (
        SELECT   B.Week_no,COUNT(A.booking_id) as count_c
        FROM bookings_Table A
        JOIN Date_Table B ON A.check_in_date = B.Date
        GROUP BY   B.Week_no) B
    UNION
	SELECT  c.Week_no, NULL as capacity, null as Total_booking, c.TOTAL_CANCELLED_BOOKING AS Cancelled_booking
    FROM (
        SELECT    B.Week_no, COUNT(*) AS TOTAL_CANCELLED_BOOKING
        FROM bookings_Table A
        JOIN Date_Table B ON A.check_in_date = B.Date
		WHERE booking_status = 'CANCELLED'
        GROUP BY   B.Week_no
		) c
		) D
GROUP BY D.Week_no
ORDER BY Total_capacity DESC, Total_booking DESC

```

|Week_no	|Total_capacity|	Total_booking	|Cancelled_booking|
|----------|-------------------|-------------------|------------------|
|32	|3k|	2k|	0k|
|23|	18k|	9k|	2k|
|30	|18k|	9k	|2k|
|31	|18k|	9k|	2k|
|21	|18k|	9k|	2k|
|26|	18k|	9k|	2k|
|27	|18k	|11k|	3k|
|28|	18k|	11k|	3k|
|29|	18k|	11k|	3k|
|22	|18k|	11k	|3k|
|19	|18k|	11k|	3k|
|20|	18k|	11k|	3k|
|24	|18k|	11k|	3k|
|25	|18k|	11k|	3k|


## 1.7 BY PLATFORM :

```SQL

SELECT D.booking_platform,
    CONCAT(CAST(ROUND(SUM(D.count_c) / 1000.0, 0) AS INT), 'k') as Total_booking,
	CONCAT(CAST(round(SUM(D.Cancelled_booking)/ 1000.0, 0)AS INT), 'k') as Cancelled_booking
FROM (
    SELECT B.booking_platform, NULL as capacity, B.count_c,null as Cancelled_booking
    FROM (
        SELECT   booking_platform,COUNT(booking_id) as count_c
        FROM bookings_Table 
        GROUP BY   booking_platform) B
    UNION
	SELECT c.booking_platform, NULL as capacity, null as Total_booking, c.TOTAL_CANCELLED_BOOKING AS Cancelled_booking
    FROM (
        SELECT    booking_platform, COUNT(*) AS TOTAL_CANCELLED_BOOKING
        FROM bookings_Table
		WHERE booking_status = 'CANCELLED'
        GROUP BY  booking_platform
		) c
		) D
GROUP BY D.booking_platform
ORDER BY  SUM(D.count_c) DESC

```
|booking_platform|	Total_booking|	Cancelled_booking|
|--------|-----------|------------|
|others	|55k|	14k|
|makeyourtrip	|27k	|7k|
|logtrip	|15k|	4k|
|direct online|	13k	|3k|
|tripster|	10k	|2k|
|journey|	8k	|2k|
|direct offline|	7k|	2k|

## 1.8 BY PROPERTY_NAME :


```SQL
SELECT D.property_name,
    CONCAT(round(SUM(D.capacity)/1000.0 ,0),'k')  as Total_capacity,   
    CONCAT(CAST(ROUND(SUM(D.count_c) / 1000.0, 0) AS INT), 'k') as Total_booking,
	CONCAT(CAST(round(SUM(D.Cancelled_booking)/ 1000.0, 0)AS INT), 'k') as Cancelled_booking
FROM (
    SELECT A.property_name, A.capacity, NULL as count_c,NULL AS Cancelled_booking
    FROM (
        SELECT  h.property_name, SUM(A.capacity) as capacity
        FROM aggregated_bookings_Table A
        JOIN hotels h ON a.property_id = h.property_id
        GROUP BY    h.property_name) A
    UNION
    SELECT B.property_name, NULL as capacity, B.count_c,null as Cancelled_booking
    FROM (
        SELECT   h.property_name,COUNT(A.booking_id) as count_c
        FROM bookings_Table A
        JOIN hotels h ON a.property_id = h.property_id
        GROUP BY  h.property_name) B
    UNION
	SELECT  c.property_name, NULL as capacity, null as Total_booking, c.TOTAL_CANCELLED_BOOKING AS Cancelled_booking
    FROM (
        SELECT    h.property_name, COUNT(*) AS TOTAL_CANCELLED_BOOKING
        FROM bookings_Table A
        JOIN hotels h ON a.property_id = h.property_id
		WHERE booking_status = 'CANCELLED'
        GROUP BY   h.property_name
		) c
		) D
GROUP BY D.property_name
ORDER BY Total_capacity DESC, Total_booking DESC
```

|property_name	|Total_capacity|	Total_booking|	Cancelled_booking|
|--------|-----------|--------|-----------|
|Atliq Seasons|	9k|	4k|	1k|
|Atliq Exotica|	41k|	23k|	6k|
|Atliq Palace	|39k	|24k|	6k|
|Atliq City	|39k	|23k	|6k|
|Atliq Bay	|37k	|21k	|5k|
|Atliq Blu	|35k	|22k|	5k|
|Atliq Grands|	32k|	17k|	4k|

## 1.7 BY CATEGORY :

```SQL
SELECT D.category,
    CONCAT(round(SUM(D.capacity)/1000.0 ,0),'k')  as Total_capacity,   
    CONCAT(CAST(ROUND(SUM(D.count_c) / 1000.0, 0) AS INT), 'k') as Total_booking,
	CONCAT(CAST(round(SUM(D.Cancelled_booking)/ 1000.0, 0)AS INT), 'k') as Cancelled_booking
FROM (
    SELECT A.category, A.capacity, NULL as count_c,NULL AS Cancelled_booking
    FROM (
        SELECT  h.category, SUM(A.capacity) as capacity
        FROM aggregated_bookings_Table A
        JOIN hotels h ON a.property_id = h.property_id
        GROUP BY    h.category) A
    UNION
    SELECT B.category, NULL as capacity, B.count_c,null as Cancelled_booking
    FROM (
        SELECT   h.category,COUNT(A.booking_id) as count_c
        FROM bookings_Table A
        JOIN hotels h ON a.property_id = h.property_id
        GROUP BY  h.category) B
    UNION
	SELECT  c.category, NULL as capacity, null as Total_booking, c.TOTAL_CANCELLED_BOOKING AS Cancelled_booking
    FROM (
        SELECT    h.category, COUNT(*) AS TOTAL_CANCELLED_BOOKING
        FROM bookings_Table A
        JOIN hotels h ON a.property_id = h.property_id
		WHERE booking_status = 'CANCELLED'
        GROUP BY   h.category
		) c
		) D
GROUP BY D.category
ORDER BY Total_capacity DESC, Total_booking DESC
```

category	Total_capacity	Total_booking	Cancelled_booking
|--------|-----------|-----------|------------|
|Business	|87k|	51k|	13k|
|Luxury	|145k|	84k|	21k|


# OCCUPANCY %
## 1.2 BY MONTH :
```sql
SELECT B.Month_year, 
    CONCAT(ROUND(SUM(successful_bookings) / SUM(capacity) * 100, 1), '%') AS Occupancy_percent
FROM aggregated_bookings_Table A
JOIN Date_Table B
ON A.check_in_date = B.Date
GROUP BY B.Month_year
ORDER BY SUM(successful_bookings) / SUM(capacity) DESC 
```
#### Answer:
|Month_year|	Occupancy_percent |
|----------|-------------------|
|May 2022	|58.5%|
|Jul 2022	|57.6%|
|Jun 2022	|57.5%|

	
## 1.3 BY CITY :
```sql

SELECT h.city,
       CONCAT(ROUND(SUM(successful_bookings) / SUM(capacity) * 100, 1), '%') AS Occupancy_percent
FROM aggregated_bookings_Table A
JOIN hotels h ON a.property_id = h.property_id
GROUP BY h.city
ORDER BY SUM(successful_bookings) / SUM(capacity) DESC 

```
|city	|Occupancy_percent|
|--------|-----------|
|Delhi	|60.5%|
|Hyderabad|	58.1%|
|Mumbai	|57.9%|
|Bangalore|	55.8%|

## 1.4 BY Day_type :
```sql

SELECT 
      b.Day_type,
       CONCAT(ROUND(SUM(A.revenue_realized) / 1000000 , 0), ' M') AS Realised_revenue
FROM bookings_Table A
JOIN Date_Table B ON A.check_in_date = B.Date
GROUP BY  b.Day_type
ORDER BY  b.Day_type
```

|Day_type	|  Realised_revenue|
|----------|-------------------|
|Weekday	 | 1070 M|
|Weekend	|  639 M|

## 1.5 BY ROOM_CLASS :

```SQL
SELECT r.room_class,
       CONCAT(ROUND(SUM(successful_bookings) / SUM(capacity) * 100, 1), '%') AS Occupancy_percent
FROM aggregated_bookings_Table b
JOIN rooms r ON b.room_category = r.room_id
GROUP BY r.room_class;

```

|room_class	|Occupancy_percent|
|--------|-----------|
|Elite	|57.6%|
|Premium	|57.6%|
|Presidential|	59.2%|
|Standard	|57.9%|

## 1.6 BY Week_no :

```SQL

SELECT B.Week_no,
       CONCAT(ROUND(SUM(successful_bookings) / SUM(capacity) * 100, 1), '%') AS Occupancy_percent
FROM aggregated_bookings_Table A
JOIN Date_Table B ON A.check_in_date = B.Date
GROUP BY B.Week_no
having B.Week_no != '32'
ORDER BY SUM(successful_bookings) / SUM(capacity) DESC
```

|Week_no	|Occupancy_percent|
|--------|-----------|
|24	|62.4%|
|29|	62.3%|
|19	|62%|
|27	|61.9%|
|20	|61.9%|
|25	|61.8%|
|22	|61.8%|
|28	|61.8%|
|23	|51.4%|
|21	|51.1%|
|31	|51%|
|30	|51%|
|26|	51%|


## 1.8 BY PROPERTY_NAME :


```SQL
SELECT h.property_name,
       CONCAT(ROUND(SUM(successful_bookings) / SUM(capacity) * 100, 1), '%') AS Occupancy_percent
FROM aggregated_bookings_Table A
JOIN hotels h ON a.property_id = h.property_id
GROUP BY h.property_name
ORDER BY SUM(successful_bookings) / SUM(capacity) DESC


```
|property_name|	Occupancy_percent|
|--------|-----------|
|Atliq Blu|	62%|
|Atliq Palace|	60%|
|Atliq City|	59.5%|
|Atliq Bay	|58.4%|
|Atliq Exotica|	57.3%|
|Atliq Grands|	52.6%|
|Atliq Seasons|	44.6%|

## 1.7 BY CATEGORY :

```SQL
SELECT h.category,
       CONCAT(ROUND(SUM(successful_bookings) / SUM(capacity) * 100, 1), '%') AS Occupancy_percent
FROM aggregated_bookings_Table A
JOIN hotels h ON a.property_id = h.property_id
GROUP BY h.category
ORDER BY SUM(successful_bookings) / SUM(capacity) DESC
```

|category	|Occupancy_percent|
|--------|-----------|
|Business|	58.2%|
|Luxury|	57.7%|


# 1st Metric 
## REVENUE
## 1.1  Revenue :

```` sql
SELECT
  CONCAT(ROUND(SUM(revenue_realized) / 1000000 , 0), ' M') AS Revenue
FROM bookings_Table;
````
#### Answer:

```
Revenue 
 1709 M
```

## 1.2 BY MONTH :
```sql
SELECT A.Month_year, ROUND(SUM(revenue) / SUM(capacity_total), 0) AS RevPAR
FROM (
  SELECT check_in_date, SUM(revenue_realized) AS revenue
  FROM bookings_Table
  GROUP BY check_in_date) AS revenue_table,
(SELECT check_in_date, SUM(capacity) AS capacity_total
  FROM aggregated_bookings_Table
  GROUP BY check_in_date) AS capacity_table,
Date_Table A
WHERE A.Date = revenue_table.check_in_date
  AND A.Date = capacity_table.check_in_date
GROUP BY A.Month_year
ORDER BY RevPAR DESC
```
#### Answer:
|Month_year|	RevPAR|
|--------|-----------|
|Jul 2022	|7310|
|Jun 2022	|7304|
|May 2022|	7426|

## 1.3 BY CITY :
```sql


SELECT h.city, ROUND(SUM(revenue) / SUM(capacity_total), 0) AS RevPAR
FROM (
  SELECT property_id, SUM(revenue_realized) AS revenue
  FROM bookings_Table
  GROUP BY property_id) AS revenue_table,
(SELECT property_id, SUM(capacity) AS capacity_total
  FROM aggregated_bookings_Table
  GROUP BY property_id) AS capacity_table,
hotels h
WHERE h.property_id = revenue_table.property_id
  AND h.property_id = capacity_table.property_id
GROUP BY h.city
ORDER BY RevPAR DESC

```

|city	|RevPAR|
|--------|-----------|
|Mumbai	|8907|
|Delhi	|7359|
|Bangalore	|7323|
|Hyderabad|	5414|


## 1.4 BY Day_type :
```sql

SELECT A.Day_type, ROUND(SUM(revenue) / SUM(capacity_total), 0) AS RevPAR
FROM (
  SELECT check_in_date, SUM(revenue_realized) AS revenue
  FROM bookings_Table
  GROUP BY check_in_date) AS revenue_table,
(SELECT check_in_date, SUM(capacity) AS capacity_total
  FROM aggregated_bookings_Table
  GROUP BY check_in_date) AS capacity_table,
Date_Table A
WHERE A.Date = revenue_table.check_in_date
  AND A.Date = capacity_table.check_in_date
GROUP BY A.Day_type
ORDER BY RevPAR DESC
```

|Day_type|	RevPAR|
|--------|-----------|
|Weekend|	9363|
|Weekday|	6510|
## 1.5 BY ROOM_CLASS :

```SQL

SELECT r.room_class, ROUND(SUM(revenue) / SUM(capacity_total), 0) AS RevPAR
FROM (
  SELECT room_category, SUM(revenue_realized) AS revenue
  FROM bookings_Table
  GROUP BY room_category) AS revenue_table,
(SELECT room_category, SUM(capacity) AS capacity_total
  FROM aggregated_bookings_Table
  GROUP BY room_category) AS capacity_table,
rooms r
WHERE r.room_id = revenue_table.room_category
  AND r.room_id = capacity_table.room_category
GROUP BY r.room_class
ORDER BY RevPAR DESC

```

|room_class	|RevPAR|
|--------|-----------|
|Presidential |	13882|
|Premium|	8706|
|Elite	|6520|
|Standard	|4661|


## 1.8 BY PROPERTY_NAME :


```SQL
SELECT  h.property_name, ROUND(SUM(revenue) / SUM(capacity_total), 0) AS RevPAR
FROM (
  SELECT property_id, SUM(revenue_realized) AS revenue
  FROM bookings_Table
  GROUP BY property_id) AS revenue_table,
(SELECT property_id, SUM(capacity) AS capacity_total
  FROM aggregated_bookings_Table
  GROUP BY property_id) AS capacity_table,
hotels h
WHERE h.property_id = revenue_table.property_id
  AND h.property_id = capacity_table.property_id
GROUP BY h.property_name
ORDER BY RevPAR DESC

```

|property_name|	RevPAR|
|--------|-----------|
|Atliq Exotica|	7824|
|Atliq Palace	|7723|
|Atliq Blu	|7422|
|Atliq Seasons|	7410|
|Atliq City	|7293|
|Atliq Bay	|7102|
|Atliq Grands	|6532|

## 1.9 BY CATEGORY :

```SQL
SELECT  h.category, ROUND(SUM(revenue) / SUM(capacity_total), 0) AS RevPAR
FROM (
  SELECT property_id, SUM(revenue_realized) AS revenue
  FROM bookings_Table
  GROUP BY property_id) AS revenue_table,
(SELECT property_id, SUM(capacity) AS capacity_total
  FROM aggregated_bookings_Table
  GROUP BY property_id) AS capacity_table,
hotels h
WHERE h.property_id = revenue_table.property_id
  AND h.property_id = capacity_table.property_id
GROUP BY h.category
ORDER BY RevPAR DESC

```

|category|	RevPAR|
|------------|-------------|
|Business	|7498|
|Luxury	|7256|


# AVERAGE RATINGS


## 1.1  Revenue :

```` sql
SELECT ROUND(AVG(ratings_given), 2) as AVERAGE_RATINGS FROM bookings_Table 

````
#### Answer:

```
Revenue 
 1709 M
```

## 1.2 BY MONTH :
```sql
SELECT B.Month_year, 
   ROUND(AVG(ratings_given), 2) as AVERAGE_RATINGS 
FROM bookings_Table a
JOIN Date_Table B
ON A.check_in_date = B.Date
GROUP BY B.Month_year
ORDER BY AVG(ratings_given) DESC 
```
#### Answer:
|Month_year|	AVERAGE_RATINGS|
|------------|-------------|
|May 2022	|3.63|
|Jun 2022	|3.62|
|Jul 2022|	3.62|

## 1.3 BY CITY :
```sql

SELECT h.city, 
   ROUND(AVG(ratings_given), 2) as AVERAGE_RATINGS 
FROM bookings_Table a
JOIN hotels h ON A.property_id = h.property_id
GROUP BY h.city
ORDER BY AVG(ratings_given) DESC 
```

|city	|AVERAGE_RATINGS|
|------------|-------------|
|Delhi	|3.78|
|Hyderabad|	3.66|
|Mumbai	|3.65|
|Bangalore|	3.41|


## 1.5 BY ROOM_CLASS :

```SQL
SELECT r.room_class, 
   ROUND(AVG(ratings_given), 2) as AVERAGE_RATINGS 
FROM bookings_Table a
JOIN rooms r ON A.room_category = r.room_id
GROUP BY  r.room_class
ORDER BY AVG(ratings_given) DESC 

```

|room_class|	AVERAGE_RATINGS|
|------------|-------------|
|Presidential|	3.69|
|Standard	|3.63|
|Elite|	3.6|
|Premium	|3.59|

## 1.6 BY Week_no :

```SQL
SELECT B.Week_no, 
   ROUND(AVG(ratings_given), 2) as AVERAGE_RATINGS 
FROM bookings_Table a
JOIN Date_Table B ON A.check_in_date = B.Date
GROUP BY B.Week_no
ORDER BY AVG(ratings_given) DESC 

```

|Week_no|	AVERAGE_RATINGS|
|------------|-------------|
|19	|3.65|
|23	|3.65|
|31	|3.64|
|27	|3.63|
|25|	3.63|
|21|	3.62|
|20|	3.62|
|28|	3.62|
|32|	3.62|
|29|	3.61|
|26|	3.6|
|24|	3.6|
|22|	3.59|
|30	|3.59|

## 1.7 BY PLATFORM :
REVNEUE BY 

```SQL

SELECT booking_platform, 
   ROUND(AVG(ratings_given), 2) as AVERAGE_RATINGS 
FROM bookings_Table 
GROUP BY booking_platform
ORDER BY AVG(ratings_given) DESC

```

|booking_platform|	AVERAGE_RATINGS|
|---------|----------|
|journey	|3.63|
|logtrip	|3.62|
|direct offline|	3.62|
|tripster|	3.62|
|others	|3.62|
|makeyourtrip|	3.62|
|direct online|	3.61|

## 1.8 BY PROPERTY_NAME :


```SQL
SELECT h.property_name, 
   ROUND(AVG(ratings_given), 2) as AVERAGE_RATINGS 
FROM bookings_Table a
JOIN hotels h ON A.property_id = h.property_id
GROUP BY h.property_name
ORDER BY AVG(ratings_given) DESC 

```

|property_name	|AVERAGE_RATINGS|
|---------|----------|
|Atliq Blu|	3.96|
|Atliq Palace|	3.75|
|Atliq Bay	|3.71|
|Atliq City|	3.69|
|Atliq Exotica|	3.62|
|Atliq Grands	|3.1|
|Atliq Seasons|	2.29|

## 1.9 BY CATEGORY :

```SQL
SELECT h.category, 
   ROUND(AVG(ratings_given), 2) as AVERAGE_RATINGS 
FROM bookings_Table a
JOIN hotels h ON A.property_id = h.property_id
GROUP BY h.category
ORDER BY AVG(ratings_given) DESC 
```

|category	|AVERAGE_RATINGS|
|---------|----------|
|Luxury	|3.62|
|Business|	3.61|
